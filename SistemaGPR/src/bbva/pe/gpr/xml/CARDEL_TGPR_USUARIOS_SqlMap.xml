<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="CARDEL_TGPR_USUARIOS" >
  <resultMap id="ibatorgenerated_BaseResultMap" class="bbva.pe.gpr.bean.Usuario" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Oct 10 16:31:18 COT 2012.
    -->
    <result column="COD_USUARIO" property="codUsuario" jdbcType="VARCHAR" />
    <result column="NOMBRE" property="nombre" jdbcType="VARCHAR" />
    <result column="APELLIDO_PATERNO" property="apellidoPaterno" jdbcType="VARCHAR" />
    <result column="APELLIDO_MATERNO" property="apellidoMaterno" jdbcType="VARCHAR" />
    <result column="COD_ROL" property="codRol" jdbcType="DECIMAL" />
    <result column="MTO_DELEGACION" property="mtoDelegacion" jdbcType="DECIMAL" />
    <result column="ESTADO" property="estado" jdbcType="DECIMAL" />
    <result column="COD_OFICINA" property="codOficina" jdbcType="VARCHAR" />
    <result column="COD_OFICINA_ASIGNADA" property="codOficinaAsignada" jdbcType="CHAR" />
    <result column="COD_CARGO" property="codCargo" jdbcType="VARCHAR" />
    <result column="GENERO" property="genero" jdbcType="VARCHAR" />
    
  </resultMap>

  <select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_BaseResultMap" parameterClass="bbva.pe.gpr.bean.Usuario" >
    select COD_USUARIO, NOMBRE, APELLIDO_PATERNO, APELLIDO_MATERNO, COD_ROL, MTO_DELEGACION, ESTADO,
      COD_OFICINA, COD_OFICINA_ASIGNADA, COD_CARGO, GENERO
    from CARDEL.TGPR_USUARIOS
    where COD_USUARIO = #codUsuario:VARCHAR#
  </select>

  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="bbva.pe.gpr.bean.Usuario" >
    delete from CARDEL.TGPR_USUARIOS
    where COD_USUARIO = #codUsuario:VARCHAR#
  </delete>

  <insert id="ibatorgenerated_insert" parameterClass="bbva.pe.gpr.bean.Usuario" >
    insert into CARDEL.TGPR_USUARIOS (COD_USUARIO, NOMBRE, APELLIDO_PATERNO, APELLIDO_MATERNO,
      COD_ROL, MTO_DELEGACION, ESTADO, COD_OFICINA, COD_OFICINA_ASIGNADA, COD_CARGO, GENERO)
    values (#codUsuario:VARCHAR#, #nombre:VARCHAR#, #apellidoPaterno:VARCHAR#,
      #apellidoMaterno:VARCHAR#, #codRol:DECIMAL#, #mtoDelegacion:DECIMAL#, #estado:DECIMAL#,
      #codOficina:VARCHAR#, #codOficinaAsignada:CHAR#, #codCargo:VARCHAR#, #genero:VARCHAR#)
  </insert>

  <insert id="ibatorgenerated_insertSelective" parameterClass="bbva.pe.gpr.bean.Usuario" >
    insert into CARDEL.TGPR_USUARIOS
    <dynamic prepend="(" >
      <isNotNull prepend="," property="codUsuario" >
        COD_USUARIO
      </isNotNull>
      <isNotNull prepend="," property="nombre" >
        NOMBRE
      </isNotNull>
      <isNotNull prepend="," property="apellidoPaterno" >
        APELLIDO_PATERNO
      </isNotNull>
      <isNotNull prepend="," property="apellidoMaterno" >
        APELLIDO_MATERNO
      </isNotNull>
      <isNotNull prepend="," property="codRol" >
        COD_ROL
      </isNotNull>
      <isNotNull prepend="," property="mtoDelegacion" >
        MTO_DELEGACION
      </isNotNull>
      <isNotNull prepend="," property="estado" >
        ESTADO
      </isNotNull>
      <isNotNull prepend="," property="codOficina" >
        COD_OFICINA
      </isNotNull>
      <isNotNull prepend="," property="codOficinaAsignada" >
        COD_OFICINA_ASIGNADA
      </isNotNull>
      <isNotNull prepend="," property="codCargo" >
        COD_CARGO
      </isNotNull>
      <isNotNull prepend="," property="genero" >
        GENERO
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="codUsuario" >
        #codUsuario:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="nombre" >
        #nombre:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="apellidoPaterno" >
        #apellidoPaterno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="apellidoMaterno" >
        #apellidoMaterno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="codRol" >
        #codRol:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="mtoDelegacion" >
        #mtoDelegacion:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="estado" >
        #estado:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="codOficina" >
        #codOficina:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="codOficinaAsignada" >
        #codOficinaAsignada:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="codCargo" >
        #codCargo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="genero" >
        #genero:VARCHAR#
      </isNotNull>
      )
    </dynamic>
  </insert>

  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="bbva.pe.gpr.bean.Usuario" >
    update CARDEL.TGPR_USUARIOS
    <dynamic prepend="set" >
      <isNotNull prepend="," property="nombre" >
        NOMBRE = #nombre:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="apellidoPaterno" >
        APELLIDO_PATERNO = #apellidoPaterno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="apellidoMaterno" >
        APELLIDO_MATERNO = #apellidoMaterno:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="codRol" >
        COD_ROL = #codRol:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="mtoDelegacion" >
        MTO_DELEGACION = #mtoDelegacion:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="estado" >
        ESTADO = #estado:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="codOficina" >
        COD_OFICINA = #codOficina:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="codOficinaAsignada" >
        COD_OFICINA_ASIGNADA = #codOficinaAsignada:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="codCargo" >
        COD_CARGO = #codCargo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="genero" >
        GENERO = #genero:VARCHAR#
      </isNotNull>
    </dynamic>
    where COD_USUARIO = #codUsuario:VARCHAR#
  </update>

  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="bbva.pe.gpr.bean.Usuario" >
    update CARDEL.TGPR_USUARIOS
    set NOMBRE = #nombre:VARCHAR#,
      APELLIDO_PATERNO = #apellidoPaterno:VARCHAR#,
      APELLIDO_MATERNO = #apellidoMaterno:VARCHAR#,
      COD_ROL = #codRol:DECIMAL#,
      MTO_DELEGACION = #mtoDelegacion:DECIMAL#,
      ESTADO = #estado:DECIMAL#,
      COD_OFICINA = #codOficina:VARCHAR#,
      COD_OFICINA_ASIGNADA = #codOficinaAsignada:CHAR#,
      COD_CARGO = #codCargo:VARCHAR#,
      GENERO = #genero:VARCHAR#
    where COD_USUARIO = #codUsuario:VARCHAR#
  </update>
  
 <select id="getLstUsuarios" resultClass="bbva.pe.gpr.bean.Usuario" parameterClass="bbva.pe.gpr.bean.Usuario" >
  SELECT DISTINCT
  U.COD_USUARIO AS codUsuario,
  U.NOMBRE AS nombre,
  U.APELLIDO_PATERNO AS apellidoPaterno,
  U.APELLIDO_MATERNO AS apellidoMaterno,
  BS.descripcion AS genero,
  R.DESCRIPCION AS codCargo
  FROM 
       CARDEL.TGPR_USUARIOS U
       JOIN CARDEL.TGPR_USUARIO_SUBANCAS US ON US.COD_USUARIO=U.COD_USUARIO
  	   JOIN CARDEL.TGPR_BANCA_SUB  BS ON BS.COD_SUBANCA=US.COD_SUBANCA
  	   JOIN CARDEL.TGPR_BANCAS B ON B.COD_BANCA=BS.COD_BANCA
  	   JOIN CARDEL.TGPR_ROLES      R ON U.COD_ROL=R.COD_ROL
  	   JOIN CARDEL.TGPR_USUARIO_ROLES UR ON UR.COD_ROL= R.COD_ROL
  		where 
	    ( #codUsuario:VARCHAR#      IS NULL OR #codUsuario:VARCHAR#=''  OR U.COD_USUARIO            like UPPER(#codUsuario:VARCHAR#) ) AND
	    ( #nombre:VARCHAR#          IS NULL OR #nombre:VARCHAR#=''      OR U.NOMBRE                 like UPPER(#nombre:VARCHAR#)) AND
	    ( #apellidoPaterno:VARCHAR# IS NULL OR #apellidoPaterno:VARCHAR#='' OR U.APELLIDO_PATERNO   like UPPER(#apellidoPaterno:VARCHAR#)) AND
	    ( #apellidoMaterno:VARCHAR# IS NULL OR #apellidoMaterno:VARCHAR#='' OR U.APELLIDO_MATERNO   like UPPER(#apellidoMaterno:VARCHAR#)) AND
	    ( #genero:VARCHAR#          IS NULL OR #genero:VARCHAR#=''      OR BS.COD_BANCA             like UPPER(#genero:VARCHAR#)) AND
	    ( #codRol:DECIMAL#          IS NULL OR #codRol:DECIMAL#=-1      OR UR.COD_ROL=#codRol:DECIMAL#) AND
	    ( #estado:DECIMAL#          IS NULL OR U.ESTADO=#estado:DECIMAL#) 
	</select>

	<update id="getAsignarOficina"  parameterClass="bbva.pe.gpr.bean.Usuario" >
    UPDATE CARDEL.TGPR_USUARIOS
    SET    COD_OFICINA_ASIGNADA = #codOficinaAsignada:CHAR#,
    WHERE  COD_USUARIO = #codUsuario:VARCHAR#
  </update>

 </sqlMap>